$def with (nodes, stats)

$code:
    def is_list_of_pure_type(list_, type_):
        # bool is instance of int in python
        if type_ == int:
            if any([isinstance(l, bool) for l in list_]):
                return False
        return all([isinstance(l, type_) for l in list_])
    
    def findminmax(list_of_num):
        maxval = 0
        minval = float('Inf')
        for i in list_of_num:
            if i > maxval:
                maxval = i
            if i < minval:
                minval = i
        return maxval, minval
 
    def graph_chart():
        output = []
        
    def graph_hist(h_list):
        output = []
        if is_list_of_pure_type(h_list, int) or is_list_of_pure_type(h_list, float):
            maxval, minval = findminmax(h_list)
            output.append(str(h_list[0]))
            
            output.append('<div class="ct-chart ct-golden-section" id="chart1"></div>')            
            return '\n'.join(output)            
            output.append('<ul class="chart">')
            
            for n, val in enumerate(h_list):
                minval = 0
                percent = int(((val-(minval))/float(maxval))*100)
                output.append('<li><span style="height:{0}%" title="{1}"></span></li>'.format(percent, val))
            output.append('</ul>')
            return '\n'.join(output)

        
        num = float(len(h_list))
        #output.append(str(h_list[0]))
        for i, name in enumerate(h_list):
            alpha = int(((i) * (1/num))*255)
            #output.append('<div class="history" style="color: rgb({0},{0},{0})">{1}</div>'.format(alpha, name))
        return '\n'.join(output)

<HTML>
    <HEAD>
        <META name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
        <link rel="stylesheet" href="static/css/chartist.min.css">
        <script src="static/js/chartist.min.js"></script>
        <LINK rel="stylesheet" href="static/bs/css/bootstrap.min.css" crossorigin="anonymous">
        <LINK rel="stylesheet" href="static/bs/fa/css/font-awesome.min.css">
        <LINK rel="stylesheet" href="static/custom.css"> 
        <!-- <LINK rel="icon" type="image/png" href="static/img/favicon.ico"/> -->
        <LINK rel="icon" type="image/png" href="static/img/icon_128.png" sizes="128x128">
</HEAD>

<BODY>

    <UL class="topnav" id="myTopnav">
        <img src="static/img/logo.png" height="80%"> </img>
    </UL>
    <BR>

        <DIV class="container-fluid">



</script>



            $if len(nodes.keys()) == 0:
                <i class="fa fa-power-off" aria-hidden="true"></i> No active clients registered.
   

            $for num, (host, server_dict) in enumerate(nodes.iteritems()):
                $if num % 2 == 0:
                    <DIV class="col-md-12 oddrow">
                $else:
                    <DIV class="col-md-12 evenrow">
                
                <DIV class="wrapper" data-toggle="collapse" data-target="#$server_dict['id'][0]">
                    <div class="pmc_row_header">
                        <i class="fa $server_dict['icon'][0]" aria-hidden="true"></i>
                    </div>
                    <div class="pmc_row">
                        $host
                    </div>
                    <div class="pmc_row_header">
                        $if server_dict['inactive'][0]:
                            <i class="fa fa-ban" aria-hidden="true"></i>
                        $else:
                            <i class="fa fa-check" aria-hidden="true"></i>
                    </div>

                    <div class="pmc_row_header">
                        <i class="fa fa-info-circle pushable" aria-hidden="true"></i>
                    </div>
                </DIV> <!-- wrapper -->
                <DIV id="$server_dict['id'][0]" class="collapse col-md-12">
                    <!--<div class="ct-chart ct-perfect-fourth" style="width: 400px;height100px;"></div>
                    <script>var data = {labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri'],series: [[5, 2, 4, 2, 0]]};new Chartist.Line('.ct-chart', data);</script>-->



                    <UL class="list-group">
                    $for num, (item, value) in enumerate(server_dict.iteritems()):
                        <li class="list-group-item"><strong>$item:</strong>
                        $#:graph_hist(value)
                        $if is_list_of_pure_type(value, int) or is_list_of_pure_type(value, float):
                            <div class="ct-chart ct-perfect-fourth" id="a$server_dict['id'][0]$num" style="height: 100px; width:100%"></div>
                            <script>

                            var options = {
                                showPoint: false,
                                //lineSmooth: false,
                                width: 900,
                                height: 100,
                       
                            };

                            var responsiveOptions = [
                                ['screen and (min-width: 641px) and (max-width: 1024px)', {width: 600, height: 100}],
                                ['screen and (max-width: 640px)', {width: 250, height: 100}]
                            ];

                            new Chartist.Line('#a$server_dict['id'][0]$num', {
                                series: [$value]
                            }, options, responsiveOptions);

                            </script>

                        $else:
                            $value[0]

                        </li>
                    </UL>
                </DIV>
                </DIV> 
        
        </DIV> <!-- container-fluid -->


        <!--Some generic info goes into the footer-->
        <div id="footer">
            <i class="fa fa-bolt" aria-hidden="true"></i>
            poor man's cloud 
            <i class="fa fa-github" aria-hidden="true"></i>
            <a href=http://github.com/woelper/pmc>github</a>
            <i class="fa fa-info-circle" aria-hidden="true"></i>
            $len(nodes)
            tracked, $stats['updates'] updates received 
            <i class="fa fa-rocket" aria-hidden="true"></i> 
            don't panic
        </div>

        <SCRIPT src="static/js/jquery.min.js"></SCRIPT>
        <SCRIPT src="static/bs/js/bootstrap.min.js" crossorigin="anonymous"></SCRIPT>
    


    </BODY>
</HTML>
